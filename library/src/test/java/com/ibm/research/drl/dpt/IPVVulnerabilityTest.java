/******************************************************************
*                                                                 *
* Copyright IBM Corp. 2015                                        *
*                                                                 *
*******************************************************************/
package com.ibm.research.drl.dpt;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.ibm.research.drl.dpt.generators.ItemSet;
import com.ibm.research.drl.dpt.vulnerability.IPVVulnerability;
import org.junit.jupiter.api.Test;

import static org.hamcrest.CoreMatchers.is;
import static org.hamcrest.MatcherAssert.assertThat;

public class IPVVulnerabilityTest {
    @Test
    public void testSerialization() throws Exception {
        ObjectMapper mapper = new ObjectMapper();

        IPVVulnerability vulnerability = new IPVVulnerability(new ItemSet(0, 1));

        String s = mapper.writeValueAsString(vulnerability);
        assertThat(vulnerability, is(mapper.readValue(s, IPVVulnerability.class)));
        assertThat(mapper.writeValueAsString(mapper.readValue(s, IPVVulnerability.class)), is(s));
    }
}
