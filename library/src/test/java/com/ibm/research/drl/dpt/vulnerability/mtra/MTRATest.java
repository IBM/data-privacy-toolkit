/*******************************************************************
 *                                                                 *
 * Copyright IBM Corp. 2016                                        *
 *                                                                 *
 *******************************************************************/
package com.ibm.research.drl.dpt.vulnerability.mtra;

import com.ibm.research.drl.dpt.datasets.IPVDataset;
import com.ibm.research.drl.dpt.vulnerability.IPVVulnerability;
import org.junit.jupiter.api.Test;

import java.util.Collection;

import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.is;

public class MTRATest {

    @Test
    public void testOnData() throws Exception {
        IPVDataset dataset = IPVDataset.load(getClass().getResourceAsStream("/100.csv"), false, ',', '"', false);

        for(int i = 0; i < 1000; i++) {
            MTRA algorithm = new MTRA(1, 1.5);
            Collection<IPVVulnerability> vulnerabilities = algorithm.apply(dataset);

            assertThat(vulnerabilities.size(), is((int) (Math.pow(2, dataset.getNumberOfColumns()) - 1)));

            for (IPVVulnerability vulnerability : vulnerabilities) {
                String vul = vulnerability.toString();
            }
        }
    }
}
