/*******************************************************************
 *                                                                 *
 * Copyright IBM Corp. 2019                                        *
 *                                                                 *
 *******************************************************************/
package com.ibm.research.drl.dpt.spark.vulnerability;

import com.fasterxml.jackson.annotation.JsonInclude;

import java.util.Collection;
import java.util.List;
import java.util.Map;

@JsonInclude(value = JsonInclude.Include.NON_NULL)
public class VulnerabilityReport {
    private final Collection<List<String>> vulnerabilities;
    private final int k;
    private final Map<List<String>, Long> offendingRecords;
    private final long totalRecords;
    
    public VulnerabilityReport(int k,
                               Collection<List<String>> vulnerabilities,
                               Map<List<String>, Long> offendingRecords,
                               long totalRecords) {
        this.vulnerabilities = vulnerabilities;
        this.k = k;
        this.offendingRecords = offendingRecords;
        this.totalRecords = totalRecords;
    }

    public VulnerabilityReport(VulnerabilityDetectionConfiguration configuration, Collection<List<String>> vulnerabilities, Map<List<String>, Long> offendingRecords, long totalRecords) {
        this(
                configuration.getK(),
                vulnerabilities,
                offendingRecords,
                totalRecords
        );
    }

    public long getTotalRecords() {
        return this.totalRecords;
    }
    
    public Collection<List<String>> getVulnerabilities() {
        return vulnerabilities;
    }

    public int getK() {
        return k;
    }

    public Map<List<String>, Long> getOffendingRecords() {
        return offendingRecords;
    }
}
